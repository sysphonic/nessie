<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="description" content="HTML/CSS Layout Editor + HTML5 IndexedDB Editor">
  <meta name="keywords" content="html editor, html layout, css editor, stylesheet editor, html css layout editor, indexeddb editor, html5 indexeddb">
  <meta name="robots" content="all">
  <meta name="distribution" content="global">

  <title>nessie Project</title>
  <link rel="stylesheet" type="text/css" href="css/nessie_project.css" media="all"/>
</head>
<body>
<table style="background-color:#ffe4b5; width:100%;">
  <tr>
    <td>

      <table id="stem_stack">
        <tr>
          <td>
            <table style="width:100%;">
              <tr>
                <td colspan="3">
                      <!--
                  <table style="width:100%;">
                    <tr style="height:30px;">
                      <td style="text-align:right;">
                        <a class="a_underline" href="index.html">English</a>
                      </td>
                    </tr>
                  </table>
                      -->
                </td>
              </tr>
              <tr>
                <td style="width:20%;"></td>
                <td style="width:60%; font-size:14pt; padding:5px; text-align:center;">
                  <table style="width:100%; border-spacing:3px; border-radius:7px; border:2px solid lightsteelblue; border-right:2px solid darkblue; border-bottom:2px solid darkblue;">
                    <tr style="height:150px;">
                      <td class="caption" style="text-align:center; vertical-align:middle; border-bottom:solid silver 1px; background:url('img/guitar_bg.png') no-repeat center right;">
                        <div style="font-size:34pt; color:dimgray;">
                          nessie Project
                        </div>
                        <div style="font-size:12pt; color:darkgray; margin-top:10px;">
                          HTML/CSS Layout Editor + HTML5 IndexedDB Editor
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td style="font-family:Times New Roman; font-size:28px; vertical-align:middle; padding:5px 0px;">
                        <a href="http://sysphonic.com/" target="_blank" style="text-decoration:none; color:black;">
                          <img src="img/sysphonic_tiny.png" /> Sysphonic
                        </a>
                      </td>
                    </tr>
                  </table>
                  <br/>
                </td>
                <td style="width:20%;">
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td style="padding:0px;">
            <hr size="1">
            <span style="float:right; margin-right:60px;">
              <a href="#nessie" style="text-decoration:none"><span class="capbox arrow">&or;</span> nessie - HTML/CSS Layout Editor</a><br/>
              <a href="#nessiefoot" style="text-decoration:none"><span class="capbox arrow">&or;</span> nessiefoot - HTML5 IndexedDB Editor</a><br/>
            </span>
          </td>
        </tr>
        <tr>
          <td style="text-align:center;">
            <a name="nessie"></a>
            <table style="width:90%; margin:0px auto;">
              <tr>
                <td class="caption" style="text-align:left; background-color:gray; color:white; padding:2px 10px;">
                  <span style="font-weight:bold;">nessie</span>
                  <span style="float:right; margin-right:20px;">HTML/CSS Layout Editor</span>
                </td>
              </tr>
              <tr>
                <td style="text-align:left;">
                  <table style="width:95%; margin:0px auto;">
                    <tr>
                      <td>
                        (Unreleased)
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td style="text-align:center;">
            <a name="nessiefoot"></a>
            <table style="width:90%; margin:0px auto;">
              <tr>
                <td class="caption" style="text-align:left; background-color:dodgerblue; color:white; padding:2px 10px;">
                  <span style="font-weight:bold;">nessiefoot</span>
                  <span style="float:right; margin-right:20px;">HTML5 IndexedDB Editor</span>
                </td>
              </tr>
              <tr>
                <td style="text-align:left;">
                  <table style="width:100%;">
                    <tr>
                      <td style="vertical-align:top;">
                        Open-Source under <span style="text-decoration:underline;">New BSD License</span>.<br/>
                        <span class="capbox" style="background-color:salmon;">Download</span> <a href="https://github.com/sysphonic/nessie" target="_blank">https://github.com/sysphonic/nessie</a><br/>
                        <span class="capbox" style="background-color:blueviolet;">Contact</span> <a href="https://github.com/sysphonic/nessie/issues" target="_blank">https://github.com/sysphonic/nessie/issues</a>
                        <ol>
                          <li>Place the whole nessie project in your site which accesses HTML5 IndexedDB.</li>
                          <li>Access <span style="font-weight:bold;">http:// .. /nessie/foot.html</span></li>
                          <li>Specify your Database name.</li>
                        </ol>
<div style="width:1px; height:1px; overflow:hidden; color:white;">
var rxw = "readwrite";

function ixDatabase(db)
{
  this.name = String(db.name);
  this.version = db.version;
  this.stores = [];
}

function ixStore(oDatabase, store)
{
  this.db = oDatabase;
  this.name = String(store.name);
  this.keyPath = store.keyPath;
  this.fieldNames = [String(this.keyPath)];
  this.indices = [];
  this.records = [];

  for (var i=0; i < store.indexNames.length; i++) {
    var indexName = store.indexNames.item(i);
    var index = store.index(indexName);
    this.indices.push(new ixIndex(index));
  }
  this.indices.sort(function(a, b){return (((a.unique)?0:1) - ((b.unique)?0:1))});

  for (var i=0; i < this.indices.length; i++) {
    var oIndex = this.indices[i];
    this.fieldNames.push(String(oIndex.keyPath));
  }
  var oStore = this;
  this.addRecord = function(rec) {
    this.records.push(new ixRecord(rec, oDatabase, oStore));
  };
  this.clearRecords = function() {
    this.records = [];
  };
  return this;
}

function ixIndex(index)
{
  this.name = String(index.name);
  this.keyPath = index.keyPath;
  this.unique = index.unique;

  return this;
}

function ixRecord(rec, oDatabase, oStore)
{
  this.db = oDatabase;
  this.store = oStore;
  this.attrs = {};
  this.updateAttrs = function(attrs) {
    for (var attr in attrs) {
      this.attrs[attr] = attrs[attr];
    }
    var keyPath = oStore.keyPath;
    this.keyPathVal = this.attrs[keyPath];
  };
  this.updateAttrs(rec);
  return this;
}

function ixGetIndexDb()
{
  var oIndexDb = null;
  if (window.indexedDB) {
     oIndexDb = window.indexedDB
  }
  return oIndexDb;
}

function ixOpenDb(dbName, dbVer, execFunc, execArgs)
{
  var oIndexDb = ixGetIndexDb();
  if (oIndexDb == null) {
     return false;
  }

  var db = null; 

  var req = null;
  if (dbVer == null) {
    req = oIndexDb.open(dbName);
  } else {
    req = oIndexDb.open(dbName, dbVer);
  }
  req.onsuccess = function(evt) {
    db = evt.target.result;
    if (execFunc) {
      execFunc(db, execArgs);
    }
  };
//req.onerror = failureHandler();
//req.onblocked = blockedHandler();
//req.onupgradeneeded = function(evt) {};
  return true;
}


var clearStoresReqIdx = 0;
var clearStores_h = {};

function ixClearStores(stores, onsuccess)
{
  if (stores.length > 0) {
    var reqIdx = clearStoresReqIdx++;
    clearStores_h[reqIdx] = stores.length;
    for (var i=0; i < stores.length; i++) {
      var req = stores[i].clear();
      req.onsuccess = function(evt) {
        if ((--clearStores_h[reqIdx] == 0) && onsuccess) {
          onsuccess();
        }
      };
    }
  } else {
    if (onsuccess) {
      onsuccess();
    }
  }
}

function ixDeleteDb(dbName, execFunc)
{
  var oIndexDb = ixGetIndexDb();
  if (oIndexDb == null) {
     return false;
  }
  var req = oIndexDb.deleteDatabase(dbName);
  req.onsuccess = function(evt) {
    if (execFunc) {
      execFunc();
    }
  }
  req.onerror = function(evt)
  {
    if (execFunc) {
      execFunc();
    }
  }
}

function _ixScan(db, args)
{
  var tx = args[0];
  var storeName = args[1];
  var onsuccess = args[2];
  var beforeCallbackFunc = args[3];

  tx = (tx || db.transaction(storeName, rxw));
  var store = tx.objectStore(storeName);

  var arr = [];

  var req = store.openCursor();
  req.onsuccess = function(evt) {
    var cursor = evt.target.result;
    if (!cursor) {
      if (onsuccess) {
        if (beforeCallbackFunc) {
          arr = beforeCallbackFunc(arr);
        }
        onsuccess(store, arr);
      }
      return;
    }
    arr.push(cursor.value);

    eval("cursor.continue()");  // eval() for IE8 which is sensitive to keyword 'continue'.
  };
}

function _ixSave(db, args)
{
  var storeName = args[0];
  var attrs = args[1];
  var onsuccess = args[2];

  var tx = db.transaction([storeName], rxw);

  var store = tx.objectStore(storeName);

  if (attrs[store.keyPath] == null) {
    delete(attrs[store.keyPath]);
  }

  store.put(
      attrs
    ).onsuccess = function(evt) {
    };

  if (onsuccess) {
    tx.oncomplete = function(evt) {
      onsuccess();
    };
  }
  return true;
}

function ixDeleteRecords(dbName, storeName, keyVals, onsuccess, beforeCallbackFunc)
{
  ixOpenDb(dbName, null, _ixDeleteRecords, [storeName, keyVals, onsuccess, beforeCallbackFunc]);
}

function _ixDeleteRecords(db, args)
{
  var storeName = args[0];
  var keyVals = args[1];
  var onsuccess = args[2];
  var beforeCallbackFunc = args[3];

  var onscanned = function(store, records) {
    var tx = store.transaction;
    tx.oncomplete = function(evt) {
      onsuccess(store, records);
    };
    var keyPath = store.keyPath;
    for (var i=0; i < records.length; i++) {
      var record = records[i];
      if (!keyVals || (keyVals.indexOf(String(record[keyPath])) >= 0)) {
        store.delete(record[keyPath]);
      }
    }
  };
  _ixScan(db, [null, storeName, onscanned, beforeCallbackFunc]);
}
</div>
                      </td>
                      <td style="padding:10px 0px 10px 5px;">
                        <img src="img/nessiefoot.png" title="nessiefoot - HTML5 IndexedDB Editor" />
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td style="padding:1px; line-height:1.3; font-size:9pt; color:white; text-align:center; vertical-align:middle; background:url('img/woody.png');">
            &copy;2016 Sysphonic
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>

</body>
</html>
